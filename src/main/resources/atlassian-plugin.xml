<atlassian-plugin key="${project.groupId}.${project.artifactId}" name="${project.name}" plugins-version="2">
  <plugin-info>
    <description>${project.description}</description>
    <version>${project.version}</version>
    <vendor name="${project.organization.name}" url="${project.organization.url}"/>
    <param name="configure.url">/admin/staticCache/configure.action</param>
  </plugin-info>

  <resource name="i18n" type="i18n" location="org.kohsuke.confluence.scache.i18n"/>

  <component name="Static Cache Generator Configuration Manager" class="org.kohsuke.confluence.scache.ConfigurationManager"
             key="configurationManager">
    <description>Configuration of static cache generator</description>
  </component>

  <component name="Static Cache Generator" class="org.kohsuke.confluence.scache.StaticPageGenerator"
             key="staticPageGenerator" public="true">
    <description>Actual page generator</description>
    <interface>com.atlassian.sal.api.lifecycle.LifecycleAware</interface>
  </component>

  <listener name="Static Cache Generator" class="org.kohsuke.confluence.scache.EventListenerImpl"
            key="eventListenerImpl">
    <description>Renders HTML version of the page</description>
  </listener>

  <component-import key="pluginScheduler">
    <description>SAL Scheduler</description>
    <interface>com.atlassian.sal.api.scheduling.PluginScheduler</interface>
  </component-import>

  <!-- adds this to the system config UI -->
  <web-item name="Admin Menu Link" key="confluenceAdminMenuLink" section="system.admin/configuration" application="com.atlassian.confluence">
      <label key="staticCache.admin.label"/>
      <link>/admin/staticCache/configuration.action</link>
  </web-item>

  <xwork name="Static Cache Generator Administration" key="staticCacheAction">
    <description>Action to enable browser-based configuration of the Static Cache Generator Plugin.</description>
    <package name="staticCache" extends="default" namespace="/admin/staticCache">

      <action class="org.kohsuke.confluence.scache.ConfigurationAction"
              name="configuration">
        <result name="success" type="velocity">
          /org/kohsuke/confluence/scache/templates/ConfigurationAction_success.vm
        </result>
        <interceptor-ref name="defaultStack"/>
      </action>

      <action class="org.kohsuke.confluence.scache.ConfigurationAction"
              name="configuration-save" method="configure">
        <result name="success" type="velocity">
          /org/kohsuke/confluence/scache/templates/ConfigurationAction_success.vm
        </result>
        <interceptor-ref name="defaultStack"/>
      </action>

      <action class="org.kohsuke.confluence.scache.ConfigurationAction"
              name="configuration-regenerate" method="regenerate">
        <result name="success" type="velocity">
          /org/kohsuke/confluence/scache/templates/ConfigurationAction_success.vm
        </result>
        <interceptor-ref name="defaultStack"/>
      </action>
    </package>
  </xwork>
</atlassian-plugin>
